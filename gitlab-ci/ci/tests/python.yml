---
job-defaults:
    optimization:
        skip-unless-changed:
            - "**/*.py"


black:
    description: "Run `black` to ensure strict code style"
    run:
        command: black --check .

flake8:
    description: "Run `flake8` to ensure code validates PEP8"
    run:
        command: flake8

isort:
    description: "Run `isort` to ensure python import statements are well ordered"
    run:
        command: isort --check --diff .

pyupgrade:
    description: "Run `pyupgrade` to ensure new code is written with the latest syntax"
    run:
        command: pyupgrade --py310-plus $(find . -name '*.py')

unit:
    description: "Run `unit tests` to validate the latest changes"
    run:
        command: >-
            pip install --prefix "/runner/.local" --no-deps --editable . &&
            pytest --pyargs jobgraph
